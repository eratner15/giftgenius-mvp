"use strict";(self.webpackChunkgiftgenius_frontend=self.webpackChunkgiftgenius_frontend||[]).push([[514],{514:(e,t,s)=>{s.r(t),s.d(t,{CollaborationManager:()=>n,CollaborativeGiftList:()=>l,ListActivityFeed:()=>m,default:()=>h});var a=s(555),i=s(43),o=s(579);class n{constructor(){this.lists=new Map,this.collaborators=new Map,this.activeConnections=new Set,this.websocket=null}createList(e,t,s){const a="list_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),i={id:a,name:e,description:t,owner:s,collaborators:[],items:[],votes:new Map,comments:[],created:Date.now(),updated:Date.now(),isPublic:!1,shareCode:this.generateShareCode()};return this.lists.set(a,i),this.saveToStorage(),i}generateShareCode(){return Math.random().toString(36).substr(2,9).toUpperCase()}addCollaborator(e,t){const s=this.lists.get(e);return s?(s.collaborators.find(e=>e.id===t.id)||(s.collaborators.push((0,a.A)((0,a.A)({},t),{},{joinedAt:Date.now(),permissions:["view","comment","vote","add_items"]})),s.updated=Date.now(),this.saveToStorage(),this.broadcastUpdate(e,{type:"collaborator_joined",data:t})),s):null}addItemToList(e,t,s){const i=this.lists.get(e);if(!i)return null;const o=(0,a.A)((0,a.A)({},t),{},{id:"item_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),addedBy:s,addedAt:Date.now(),votes:0,comments:[]});return i.items.push(o),i.updated=Date.now(),this.saveToStorage(),this.broadcastUpdate(e,{type:"item_added",data:o}),o}voteForItem(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"up";const i=this.lists.get(e);if(!i)return null;const o=i.items.find(e=>e.id===t);if(!o)return null;const n="".concat(t,"_").concat(s),l=i.votes.get(n);return l===a?(i.votes.delete(n),o.votes+="up"===a?-1:1):(o.votes+=l?"up"===a?2:-2:"up"===a?1:-1,i.votes.set(n,a)),i.updated=Date.now(),this.saveToStorage(),this.broadcastUpdate(e,{type:"item_voted",data:{itemId:t,votes:o.votes,userId:s,voteType:a}}),o}addComment(e,t,s,i){const o=this.lists.get(e);if(!o)return null;const n=o.items.find(e=>e.id===t);if(!n)return null;const l={id:"comment_".concat(Date.now()),text:s,userId:i,timestamp:Date.now()};return n.comments.push(l),o.comments.push((0,a.A)((0,a.A)({},l),{},{itemId:t})),o.updated=Date.now(),this.saveToStorage(),this.broadcastUpdate(e,{type:"comment_added",data:{itemId:t,comment:l}}),l}broadcastUpdate(e,t){const s=new CustomEvent("list-update",{detail:{listId:e,update:t}});window.dispatchEvent(s)}saveToStorage(){const e=Array.from(this.lists.entries());localStorage.setItem("collaborative_lists",JSON.stringify(e))}loadFromStorage(){const e=localStorage.getItem("collaborative_lists");if(e){const t=JSON.parse(e);this.lists=new Map(t.map(e=>{let[t,s]=e;return[t,(0,a.A)((0,a.A)({},s),{},{votes:new Map(s.votes||[])})]}))}}}const l=e=>{let{listId:t,currentUser:s,onItemClick:l,onShare:m}=e;const[h,u]=(0,i.useState)(null),[p,v]=(0,i.useState)(!0),[x,j]=(0,i.useState)(!1),[g,b]=(0,i.useState)(!1),[N,C]=(0,i.useState)("all"),[f,y]=(0,i.useState)("votes"),w=(0,i.useRef)(new n);(0,i.useEffect)(()=>{w.current.loadFromStorage();const e=w.current.lists.get(t);if(e)u(e);else{const e=w.current.createList("Gift Ideas","Collaborative gift list",s);u(e)}v(!1);const i=e=>{if(e.detail.listId===t){const e=w.current.lists.get(t);u((0,a.A)({},e))}};return window.addEventListener("list-update",i),()=>window.removeEventListener("list-update",i)},[t,s]);if(p)return(0,o.jsx)("div",{className:"loading",children:"Loading collaborative list..."});if(!h)return(0,o.jsx)("div",{className:"error",children:"List not found"});const A=(()=>{if(!h)return[];let e=[...h.items];switch("my-items"===N?e=e.filter(e=>e.addedBy.id===s.id):"top-voted"===N&&(e=e.filter(e=>e.votes>0)),f){case"votes":e.sort((e,t)=>t.votes-e.votes);break;case"newest":e.sort((e,t)=>t.addedAt-e.addedAt);break;case"price-low":e.sort((e,t)=>e.price-t.price);break;case"price-high":e.sort((e,t)=>t.price-e.price)}return e})();return(0,o.jsxs)("div",{className:"collaborative-gift-list",children:[(0,o.jsxs)("div",{className:"list-header",children:[(0,o.jsxs)("div",{className:"list-info",children:[(0,o.jsx)("h2",{children:h.name}),(0,o.jsx)("p",{children:h.description}),(0,o.jsxs)("div",{className:"list-meta",children:[(0,o.jsxs)("span",{className:"collaborator-count",children:["\ud83d\udc65 ",h.collaborators.length+1," collaborators"]}),(0,o.jsxs)("span",{className:"item-count",children:["\ud83c\udf81 ",h.items.length," items"]})]})]}),(0,o.jsxs)("div",{className:"list-actions",children:[(0,o.jsx)("button",{className:"add-item-btn",onClick:()=>j(!0),children:"+ Add Gift"}),(0,o.jsx)("button",{className:"invite-btn",onClick:()=>b(!0),children:"\ud83d\udc65 Invite"}),(0,o.jsx)("button",{className:"share-list-btn",onClick:()=>m&&m(h),children:"\ud83d\udce4 Share"})]})]}),(0,o.jsxs)("div",{className:"list-controls",children:[(0,o.jsxs)("div",{className:"filter-controls",children:[(0,o.jsx)("label",{children:"Filter:"}),(0,o.jsxs)("select",{value:N,onChange:e=>C(e.target.value),children:[(0,o.jsx)("option",{value:"all",children:"All Items"}),(0,o.jsx)("option",{value:"my-items",children:"My Items"}),(0,o.jsx)("option",{value:"top-voted",children:"Top Voted"})]})]}),(0,o.jsxs)("div",{className:"sort-controls",children:[(0,o.jsx)("label",{children:"Sort by:"}),(0,o.jsxs)("select",{value:f,onChange:e=>y(e.target.value),children:[(0,o.jsx)("option",{value:"votes",children:"Most Voted"}),(0,o.jsx)("option",{value:"newest",children:"Newest First"}),(0,o.jsx)("option",{value:"price-low",children:"Price: Low to High"}),(0,o.jsx)("option",{value:"price-high",children:"Price: High to Low"})]})]})]}),(0,o.jsxs)("div",{className:"collaborator-avatars",children:[h.collaborators.slice(0,5).map((e,t)=>(0,o.jsx)("div",{className:"collaborator-avatar",style:{left:"".concat(25*t,"px")},title:e.name,children:e.name.charAt(0).toUpperCase()},e.id)),h.collaborators.length>5&&(0,o.jsxs)("div",{className:"collaborator-more",style:{left:"125px"},children:["+",h.collaborators.length-5]})]}),(0,o.jsxs)("div",{className:"list-items",children:[A.map(e=>(0,o.jsx)(c,{item:e,currentUser:s,onVote:i=>((e,i)=>{w.current.voteForItem(t,e,s.id,i);const o=w.current.lists.get(t);u((0,a.A)({},o))})(e.id,i),onComment:i=>((e,i)=>{w.current.addComment(t,e,i,s.id);const o=w.current.lists.get(t);u((0,a.A)({},o))})(e.id,i),onClick:()=>l&&l(e)},e.id)),0===A.length&&(0,o.jsx)("div",{className:"empty-list",children:(0,o.jsx)("p",{children:"No items yet. Be the first to add a gift idea!"})})]}),x&&(0,o.jsx)(r,{onAdd:e=>{w.current.addItemToList(t,e,s);const i=w.current.lists.get(t);u((0,a.A)({},i)),j(!1)},onClose:()=>j(!1)}),g&&(0,o.jsx)(d,{list:h,onClose:()=>b(!1)})]})},c=e=>{let{item:t,currentUser:s,onVote:a,onComment:n,onClick:l}=e;const[c,r]=(0,i.useState)(!1),[d,m]=(0,i.useState)(""),h=()=>{d.trim()&&(n(d),m(""))};return(0,o.jsxs)("div",{className:"collaborative-gift-item",children:[(0,o.jsxs)("div",{className:"item-main",onClick:l,children:[(0,o.jsx)("img",{src:t.image_url||"/api/placeholder/100/100",alt:t.name||t.title,className:"item-image"}),(0,o.jsxs)("div",{className:"item-details",children:[(0,o.jsx)("h3",{children:t.name||t.title}),(0,o.jsxs)("p",{className:"item-price",children:["$",t.price]}),(0,o.jsxs)("div",{className:"item-meta",children:[(0,o.jsxs)("span",{className:"added-by",children:["Added by ",t.addedBy.name]}),(0,o.jsx)("span",{className:"added-time",children:new Date(t.addedAt).toLocaleDateString()})]})]}),(0,o.jsxs)("div",{className:"item-voting",children:[(0,o.jsx)("button",{className:"vote-btn up ".concat(""),onClick:e=>{e.stopPropagation(),a("up")},children:"\u25b2"}),(0,o.jsx)("span",{className:"vote-count",children:t.votes}),(0,o.jsx)("button",{className:"vote-btn down",onClick:e=>{e.stopPropagation(),a("down")},children:"\u25bc"})]})]}),(0,o.jsx)("div",{className:"item-actions",children:(0,o.jsxs)("button",{className:"comment-toggle",onClick:()=>r(!c),children:["\ud83d\udcac ",t.comments.length," comments"]})}),c&&(0,o.jsxs)("div",{className:"item-comments",children:[t.comments.map(e=>(0,o.jsxs)("div",{className:"comment",children:[(0,o.jsxs)("strong",{children:[e.userId,":"]})," ",e.text,(0,o.jsx)("span",{className:"comment-time",children:new Date(e.timestamp).toLocaleString()})]},e.id)),(0,o.jsxs)("div",{className:"add-comment",children:[(0,o.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"Add a comment...",onKeyPress:e=>"Enter"===e.key&&h()}),(0,o.jsx)("button",{onClick:h,children:"Post"})]})]})]})},r=e=>{let{onAdd:t,onClose:s}=e;const[n,l]=(0,i.useState)({name:"",price:"",url:"",image_url:"",notes:""});return(0,o.jsx)("div",{className:"modal-backdrop",onClick:s,children:(0,o.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,o.jsx)("h2",{children:"Add Gift Idea"}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Gift Name*"}),(0,o.jsx)("input",{type:"text",value:n.name,onChange:e=>l((0,a.A)((0,a.A)({},n),{},{name:e.target.value})),placeholder:"e.g., Wireless Headphones"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Price*"}),(0,o.jsx)("input",{type:"number",value:n.price,onChange:e=>l((0,a.A)((0,a.A)({},n),{},{price:e.target.value})),placeholder:"99.99"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Link (optional)"}),(0,o.jsx)("input",{type:"url",value:n.url,onChange:e=>l((0,a.A)((0,a.A)({},n),{},{url:e.target.value})),placeholder:"https://..."})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Notes (optional)"}),(0,o.jsx)("textarea",{value:n.notes,onChange:e=>l((0,a.A)((0,a.A)({},n),{},{notes:e.target.value})),placeholder:"Why this would be perfect...",rows:"3"})]}),(0,o.jsxs)("div",{className:"modal-actions",children:[(0,o.jsx)("button",{onClick:s,children:"Cancel"}),(0,o.jsx)("button",{onClick:()=>{n.name&&n.price&&t((0,a.A)((0,a.A)({},n),{},{price:parseFloat(n.price)}))},className:"primary",children:"Add Gift"})]})]})})},d=e=>{let{list:t,onClose:s}=e;const[a,n]=(0,i.useState)(!1),l="".concat(window.location.origin,"/list/").concat(t.id,"?code=").concat(t.shareCode);return(0,o.jsx)("div",{className:"modal-backdrop",onClick:s,children:(0,o.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,o.jsx)("h2",{children:"Invite Collaborators"}),(0,o.jsxs)("div",{className:"invite-section",children:[(0,o.jsx)("h3",{children:"Share Code"}),(0,o.jsxs)("div",{className:"share-code-display",children:[(0,o.jsx)("span",{className:"code",children:t.shareCode}),(0,o.jsx)("button",{onClick:async()=>{try{await navigator.clipboard.writeText(l),n(!0),setTimeout(()=>n(!1),2e3)}catch(e){console.error("Failed to copy:",e)}},children:a?"\u2713 Copied!":"Copy Link"})]})]}),(0,o.jsxs)("div",{className:"invite-section",children:[(0,o.jsx)("h3",{children:"Current Collaborators"}),(0,o.jsx)("div",{className:"collaborator-list",children:t.collaborators.map(e=>(0,o.jsxs)("div",{className:"collaborator-item",children:[(0,o.jsx)("div",{className:"collaborator-avatar",children:e.name.charAt(0).toUpperCase()}),(0,o.jsx)("span",{children:e.name}),(0,o.jsxs)("span",{className:"join-date",children:["Joined ",new Date(e.joinedAt).toLocaleDateString()]})]},e.id))})]}),(0,o.jsx)("div",{className:"modal-actions",children:(0,o.jsx)("button",{onClick:s,children:"Close"})})]})})},m=e=>{let{listId:t}=e;const[s,a]=(0,i.useState)([]);return(0,i.useEffect)(()=>{a([{id:1,type:"item_added",user:"John",item:"Smart Watch",time:"2 min ago"},{id:2,type:"vote",user:"Sarah",item:"Perfume Set",action:"upvoted",time:"5 min ago"},{id:3,type:"comment",user:"Mike",item:"Book Collection",comment:"Great idea!",time:"10 min ago"}])},[t]),(0,o.jsxs)("div",{className:"list-activity-feed",children:[(0,o.jsx)("h3",{children:"Recent Activity"}),(0,o.jsx)("div",{className:"activity-items",children:s.map(e=>(0,o.jsxs)("div",{className:"activity-item",children:[(0,o.jsx)("div",{className:"activity-icon",children:"item_added"===e.type?"\u2795":"vote"===e.type?"\ud83d\udc4d":"comment"===e.type?"\ud83d\udcac":"\ud83d\udcdd"}),(0,o.jsxs)("div",{className:"activity-content",children:[(0,o.jsx)("strong",{children:e.user}),"item_added"===e.type&&' added "'.concat(e.item,'"'),"vote"===e.type&&" ".concat(e.action,' "').concat(e.item,'"'),"comment"===e.type&&' commented on "'.concat(e.item,'": "').concat(e.comment,'"')]}),(0,o.jsx)("div",{className:"activity-time",children:e.time})]},e.id))})]})},h={CollaborationManager:n,CollaborativeGiftList:l,ListActivityFeed:m}}}]);
//# sourceMappingURL=514.4be11b25.chunk.js.map