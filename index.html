<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><meta name="theme-color" content="#6B46C1"/><meta name="description" content="GiftGenius - Find the perfect gift backed by real testimonials from men"/><title>GiftGenius - Gift Ideas That Actually Work</title><link rel="manifest" href="/manifest.json"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="default"/><meta name="apple-mobile-web-app-title" content="GiftGenius"/><link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E🎁%3C/text%3E%3C/svg%3E"/><meta name="mobile-web-app-capable" content="yes"/><meta name="application-name" content="GiftGenius"/><meta name="msapplication-TileColor" content="#6B46C1"/><meta name="msapplication-tap-highlight" content="no"/><link rel="preload" href="/static/css/main.45a7795f.css" as="style"/><link rel="preload" href="/static/js/main.31aa3cba.js" as="script"/><link rel="dns-prefetch" href="//images.unsplash.com"/><link rel="preconnect" href="//images.unsplash.com" crossorigin/><style>*{margin:0;padding:0;box-sizing:border-box}:root{--primary:#6B46C1;--primary-dark:#553C9A;--primary-light:#8B5CF6;--success:#10B981;--danger:#EF4444;--warning:#F59E0B;--info:#3B82F6;--light:#F3F4F6;--dark:#1F2937;--gray-50:#F9FAFB;--gray-100:#F3F4F6;--gray-200:#E5E7EB;--gray-300:#D1D5DB;--gray-400:#9CA3AF;--gray-500:#6B7280;--gray-600:#4B5563;--gray-700:#374151;--gray-800:#1F2937;--gray-900:#111827}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',sans-serif;line-height:1.6;color:var(--dark);background:linear-gradient(135deg,#667eea 0,#764ba2 100%);min-height:100vh;overflow-x:hidden}.app-container{background:#fff;min-height:100vh;position:relative}.container{max-width:1200px;margin:0 auto;padding:20px}.hero{text-align:center;padding:50px 20px;background:linear-gradient(135deg,var(--primary) 0,var(--primary-dark) 100%);color:#fff;margin-bottom:30px;position:relative;overflow:hidden}.hero::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><radialGradient id="grad" cx="50%" cy="50%" r="50%"><stop offset="0%" style="stop-color:rgba(255,255,255,0.1);stop-opacity:1" /><stop offset="100%" style="stop-color:rgba(255,255,255,0);stop-opacity:0" /></radialGradient></defs><circle cx="20" cy="20" r="2" fill="url(%23grad)" opacity="0.6"><animate attributeName="cy" values="20;80;20" dur="4s" repeatCount="indefinite"/></circle><circle cx="80" cy="40" r="1" fill="url(%23grad)" opacity="0.4"><animate attributeName="cy" values="40;90;40" dur="6s" repeatCount="indefinite"/></circle><circle cx="60" cy="60" r="1.5" fill="url(%23grad)" opacity="0.5"><animate attributeName="cy" values="60;10;60" dur="5s" repeatCount="indefinite"/></circle></svg>') repeat;opacity:.3;animation:float 20s ease-in-out infinite}@keyframes float{0%,100%{transform:translateY(0) rotate(0)}50%{transform:translateY(-10px) rotate(180deg)}}.hero h1{font-size:2.8rem;margin-bottom:15px;text-shadow:2px 2px 4px rgba(0,0,0,.3);position:relative;z-index:2;animation:slideDown .8s ease-out}.hero p{font-size:1.3rem;opacity:.95;position:relative;z-index:2;animation:slideUp .8s ease-out .2s both}@keyframes slideDown{from{transform:translateY(-30px);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes slideUp{from{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}.trust-indicators{display:flex;justify-content:center;gap:30px;margin-top:25px;flex-wrap:wrap;position:relative;z-index:2;animation:fadeIn 1s ease-out .4s both}.trust-indicator{display:flex;align-items:center;gap:8px;font-size:.95rem;background:rgba(255,255,255,.1);padding:8px 16px;border-radius:20px;backdrop-filter:blur(10px);transition:all .3s ease}.trust-indicator:hover{background:rgba(255,255,255,.2);transform:translateY(-2px)}.personalization-banner{background:linear-gradient(135deg,var(--info) 0,var(--primary) 100%);color:#fff;padding:20px 25px;border-radius:16px;margin-bottom:30px;position:relative;overflow:hidden;animation:fadeInUp .6s ease-out}.personalization-banner::before{content:'';position:absolute;top:-50%;right:-50%;width:100%;height:200%;background:linear-gradient(45deg,transparent 40%,rgba(255,255,255,.1) 50%,transparent 60%);animation:shimmer 3s infinite}@keyframes shimmer{0%{transform:translateX(-100%) translateY(-100%) rotate(45deg)}100%{transform:translateX(100%) translateY(100%) rotate(45deg)}}.personalization-content{position:relative;z-index:2;display:flex;align-items:center;gap:15px}.personalization-icon{font-size:2rem;opacity:.9}.personalization-text h3{font-size:1.2rem;margin-bottom:5px}.personalization-text p{opacity:.9;font-size:.95rem}.activity-counter{margin-left:auto;background:rgba(255,255,255,.2);padding:8px 16px;border-radius:12px;font-size:.9rem;backdrop-filter:blur(10px)}.activity-feed{background:var(--gray-50);border-radius:12px;padding:20px;margin-bottom:25px;animation:fadeIn .5s ease-out}.activity-item{display:flex;align-items:center;gap:12px;padding:10px 0;border-bottom:1px solid var(--gray-200);animation:slideInLeft .3s ease-out}.activity-item:last-child{border-bottom:none}.activity-avatar{width:32px;height:32px;border-radius:50%;background:var(--primary);color:#fff;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:600}.activity-text{flex:1;font-size:14px;color:var(--gray-700)}.activity-time{font-size:12px;color:var(--gray-500)}.trending-indicator{background:var(--danger);color:#fff;font-size:10px;padding:2px 6px;border-radius:8px;font-weight:600}.smart-recommendations{background:#fff;border-radius:16px;padding:25px;margin-bottom:30px;box-shadow:0 2px 12px rgba(0,0,0,.08);border:2px solid var(--gray-100);animation:fadeInUp .6s ease-out}.smart-recommendations h3{color:var(--primary);margin-bottom:20px;font-size:1.4rem;display:flex;align-items:center;gap:10px}.recommendation-section{margin-bottom:25px}.recommendation-section:last-child{margin-bottom:0}.recommendation-title{font-size:1.1rem;font-weight:600;color:var(--gray-800);margin-bottom:15px;display:flex;align-items:center;gap:8px}.recommendation-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px}.recommendation-card{background:var(--gray-50);border-radius:12px;padding:15px;cursor:pointer;transition:all .3s ease;border:2px solid transparent;position:relative;overflow:hidden}.recommendation-card::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(107,70,193,.1),transparent);transition:left .5s ease}.recommendation-card:hover::before{left:100%}.recommendation-card:hover{border-color:var(--primary);transform:translateY(-2px);box-shadow:0 8px 20px rgba(107,70,193,.15)}.recommendation-reason{font-size:12px;color:var(--info);font-weight:600;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px}.recommendation-name{font-weight:600;color:var(--gray-800);margin-bottom:5px}.recommendation-match{font-size:13px;color:var(--gray-600)}.toast-container{position:fixed;top:20px;right:20px;z-index:10000;display:flex;flex-direction:column;gap:10px}.toast{background:#fff;border:1px solid var(--gray-200);border-radius:8px;padding:16px 20px;box-shadow:0 4px 12px rgba(0,0,0,.15);display:flex;align-items:center;gap:12px;min-width:300px;animation:slideInRight .3s ease-out;position:relative;overflow:hidden}.toast.success{border-left:4px solid var(--success)}.toast.info{border-left:4px solid var(--info)}.toast.warning{border-left:4px solid var(--warning)}.toast::after{content:'';position:absolute;bottom:0;left:0;height:2px;background:var(--primary);animation:shrink 3s linear}@keyframes slideInRight{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}@keyframes shrink{from{width:100%}to{width:0%}}@keyframes slideInLeft{from{transform:translateX(-30px);opacity:0}to{transform:translateX(0);opacity:1}}.toast-icon{font-size:20px;flex-shrink:0}.toast-content{flex:1}.toast-title{font-weight:600;margin-bottom:2px}.toast-message{font-size:14px;color:var(--gray-600)}.search-container{position:relative;flex:1;min-width:280px}.search-input{width:100%;padding:12px 16px 12px 44px;border:2px solid var(--gray-200);border-radius:8px;font-size:16px;background:#fff;transition:all .3s ease;background-image:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="%236B7280"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>');background-repeat:no-repeat;background-position:12px center;background-size:20px}.search-input:focus{outline:0;border-color:var(--primary);box-shadow:0 0 0 3px rgba(107,70,193,.1)}.search-suggestions{position:absolute;top:100%;left:0;right:0;background:#fff;border:1px solid var(--gray-200);border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.15);max-height:300px;overflow-y:auto;z-index:1000;margin-top:4px;animation:slideDown .2s ease-out}.suggestion-item{padding:12px 16px;cursor:pointer;border-bottom:1px solid var(--gray-100);transition:background-color .2s ease;display:flex;align-items:center;gap:12px}.suggestion-item:last-child{border-bottom:none}.suggestion-item:hover{background-color:var(--gray-50)}.suggestion-item.active{background-color:var(--primary);color:#fff}.suggestion-icon{font-size:16px;opacity:.7}.suggestion-text{flex:1}.suggestion-category{font-size:12px;opacity:.6;text-transform:uppercase;letter-spacing:.5px}.active-filters{display:flex;gap:8px;margin-bottom:20px;flex-wrap:wrap;animation:fadeIn .3s ease-out}.filter-badge{background:var(--primary);color:#fff;padding:6px 12px;border-radius:16px;font-size:14px;display:flex;align-items:center;gap:6px;animation:slideIn .3s ease-out}.filter-badge-remove{cursor:pointer;font-size:16px;opacity:.8;transition:opacity .2s ease}.filter-badge-remove:hover{opacity:1}@keyframes slideIn{from{transform:scale(.8);opacity:0}to{transform:scale(1);opacity:1}}.quick-recs{background:var(--gray-50);padding:30px;border-radius:16px;margin-bottom:30px;animation:fadeInUp .6s ease-out}@keyframes fadeInUp{from{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}.quick-recs h2{color:var(--primary);margin-bottom:20px;font-size:1.6rem;text-align:center}.quick-buttons{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px}.quick-btn{padding:20px;background:#fff;border:2px solid transparent;border-radius:12px;cursor:pointer;transition:all .3s cubic-bezier(.4, 0, .2, 1);text-align:left;font-size:1rem;position:relative;overflow:hidden}.quick-btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(107,70,193,.1),transparent);transition:left .5s ease}.quick-btn:hover::before{left:100%}.quick-btn:hover{border-color:var(--primary);transform:translateY(-4px);box-shadow:0 8px 25px rgba(107,70,193,.15)}.quick-btn.active{background:var(--primary);color:#fff;transform:translateY(-2px);box-shadow:0 6px 20px rgba(107,70,193,.3)}.quick-btn .emoji{font-size:1.5rem;margin-right:12px;display:inline-block;transition:transform .3s ease}.quick-btn:hover .emoji{transform:scale(1.2) rotate(5deg)}.quick-btn .label{font-weight:600;margin-bottom:4px}.quick-btn .desc{font-size:.9rem;opacity:.8}.gift-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:24px;margin-bottom:40px}.gift-card{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.08);cursor:pointer;transition:all .4s cubic-bezier(.4, 0, .2, 1);position:relative;transform-origin:center}.gift-card::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(45deg,transparent 30%,rgba(107,70,193,.05) 50%,transparent 70%);opacity:0;transition:opacity .3s ease;pointer-events:none}.gift-card:hover::before{opacity:1}.gift-card:hover{transform:translateY(-8px) scale(1.02);box-shadow:0 12px 30px rgba(0,0,0,.15)}.gift-card img{width:100%;height:200px;object-fit:cover;transition:transform .4s ease}.gift-card:hover img{transform:scale(1.05)}.gift-badge{position:absolute;top:12px;right:12px;background:var(--success);color:#fff;padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;animation:pulse 2s infinite}.gift-badge.hot{background:var(--danger);animation:pulse 1s infinite,glow 2s infinite}.gift-badge.trending{background:var(--warning);animation:pulse 1.5s infinite}.gift-badge.ai-recommended{background:var(--info);animation:pulse 2s infinite,shimmerBadge 3s infinite}@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}@keyframes glow{0%,100%{box-shadow:0 0 5px rgba(239,68,68,.5)}50%{box-shadow:0 0 20px rgba(239,68,68,.8)}}@keyframes shimmerBadge{0%,100%{box-shadow:0 0 5px rgba(59,130,246,.5)}50%{box-shadow:0 0 15px rgba(59,130,246,.8)}}.gift-card-content{padding:18px}.gift-card h3{font-size:1.15rem;margin-bottom:8px;color:var(--dark)}.price-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.price{font-size:1.4rem;color:var(--primary);font-weight:700}.delivery{font-size:.85rem;color:var(--gray-500)}.rating-row{display:flex;align-items:center;gap:12px;margin-bottom:10px}.hearts{display:flex;gap:2px}.success-text{font-size:.9rem;color:var(--gray-600)}.testimonial-preview{font-size:.85rem;color:var(--gray-500);font-style:italic;border-left:3px solid var(--primary);padding-left:10px;margin-top:10px}.ai-insight{background:linear-gradient(135deg,var(--info) 0,var(--primary) 100%);color:#fff;padding:8px 12px;border-radius:8px;font-size:.8rem;margin-top:8px;opacity:.9}.filters{display:flex;gap:12px;margin-bottom:30px;flex-wrap:wrap;align-items:center;animation:fadeIn .4s ease-out .2s both}.filters input:not(.search-input),.filters select{padding:12px 16px;border:2px solid var(--gray-200);border-radius:8px;font-size:16px;background:#fff;min-width:150px;transition:all .3s ease}.filters input:focus,.filters select:focus{outline:0;border-color:var(--primary);box-shadow:0 0 0 3px rgba(107,70,193,.1)}.clear-filters{padding:12px 20px;background:var(--gray-100);border:none;border-radius:8px;cursor:pointer;font-size:14px;color:var(--gray-700);transition:all .3s ease;font-weight:500}.clear-filters:hover{background:var(--gray-200);transform:translateY(-1px)}.results-summary{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;padding:20px;background:var(--gray-50);border-radius:12px;animation:slideIn .4s ease-out}.results-count{font-size:1.2rem;color:var(--gray-800);font-weight:600}.sort-options{display:flex;gap:8px}.sort-btn{padding:8px 16px;background:#fff;border:1px solid var(--gray-300);border-radius:6px;cursor:pointer;font-size:14px;transition:all .3s ease}.sort-btn.active{background:var(--primary);color:#fff;border-color:var(--primary)}.sort-btn:hover:not(.active){border-color:var(--primary);color:var(--primary)}.empty-state{text-align:center;padding:80px 20px;animation:fadeIn .6s ease-out}.empty-icon{font-size:4rem;margin-bottom:20px;opacity:.6;animation:bounce 2s infinite}@keyframes bounce{0%,100%,20%,50%,80%{transform:translateY(0)}40%{transform:translateY(-10px)}60%{transform:translateY(-5px)}}.empty-title{font-size:1.5rem;color:var(--gray-700);margin-bottom:12px}.empty-message{color:var(--gray-500);margin-bottom:24px;max-width:400px;margin-left:auto;margin-right:auto}.empty-suggestions{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}.suggestion-chip{background:var(--gray-100);color:var(--gray-700);padding:8px 16px;border-radius:20px;cursor:pointer;transition:all .3s ease;font-size:14px}.suggestion-chip:hover{background:var(--primary);color:#fff;transform:translateY(-2px)}.skeleton{background:linear-gradient(90deg,var(--gray-200) 25%,var(--gray-100) 50%,var(--gray-200) 75%);background-size:200% 100%;animation:shimmer 1.5s infinite}@keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}.skeleton-card{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.08);margin-bottom:24px}.skeleton-image{width:100%;height:200px}.skeleton-content{padding:18px}.skeleton-title{height:20px;border-radius:4px;margin-bottom:12px}.skeleton-price{height:16px;width:80px;border-radius:4px;margin-bottom:8px}.skeleton-rating{height:14px;width:120px;border-radius:4px}@media (max-width:768px){.container{padding:12px}.hero{padding:40px 15px}.hero h1{font-size:2rem;line-height:1.2}.hero p{font-size:1.05rem;line-height:1.4}.trust-indicators{gap:12px;margin-top:20px}.trust-indicator{font-size:.85rem;padding:6px 12px}.personalization-banner{padding:16px 20px;margin-bottom:20px}.personalization-content{flex-direction:column;text-align:center;gap:12px}.personalization-icon{font-size:1.8rem}.personalization-text h3{font-size:1.1rem}.personalization-text p{font-size:.9rem}.activity-counter{margin-left:0;font-size:.85rem}.activity-feed{padding:16px;margin-bottom:20px}.activity-item{padding:8px 0}.activity-avatar{width:28px;height:28px;font-size:12px}.activity-text{font-size:13px}.activity-time{font-size:11px}.smart-recommendations{padding:20px;margin-bottom:20px}.smart-recommendations h3{font-size:1.2rem;margin-bottom:16px}.recommendation-section{margin-bottom:20px}.recommendation-title{font-size:1rem;margin-bottom:12px}.recommendation-grid{grid-template-columns:1fr;gap:12px}.recommendation-card{padding:12px;text-align:center}.recommendation-reason{font-size:11px}.recommendation-name{font-size:.95rem}.recommendation-match{font-size:12px}.quick-recs{padding:20px;margin-bottom:20px}.quick-recs h2{font-size:1.4rem;margin-bottom:16px}.quick-buttons{grid-template-columns:1fr;gap:12px}.quick-btn{padding:16px;text-align:center}.quick-btn .emoji{font-size:1.3rem;margin-right:8px}.quick-btn .label{font-size:.95rem}.quick-btn .desc{font-size:.85rem}.filters{gap:8px;margin-bottom:20px}.filters input:not(.search-input),.filters select{min-width:100px;font-size:16px;padding:14px 12px}.search-container{min-width:100%;order:-1}.search-input{font-size:16px;padding:14px 16px 14px 44px}.search-suggestions{margin-top:2px}.suggestion-item{padding:14px 16px;font-size:15px}.suggestion-icon{font-size:18px}.suggestion-category{font-size:11px}.clear-filters{padding:14px 16px;font-size:15px;width:100%;margin-top:8px}.active-filters{margin-bottom:16px;justify-content:center}.filter-badge{font-size:13px;padding:8px 12px}.results-summary{flex-direction:column;gap:12px;text-align:center;padding:16px;margin-bottom:20px}.results-count{font-size:1.1rem}.sort-options{flex-wrap:wrap;justify-content:center;gap:6px}.sort-btn{padding:10px 14px;font-size:13px;white-space:nowrap}.gift-grid{grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px;margin-bottom:30px}.gift-card{border-radius:12px}.gift-card-content{padding:16px}.gift-card h3{font-size:1.1rem;line-height:1.3}.price{font-size:1.3rem}.success-text{font-size:.85rem}.testimonial-preview{font-size:.8rem;line-height:1.4}.ai-insight{font-size:.75rem;padding:6px 10px}.toast-container{top:10px;right:10px;left:10px}.toast{min-width:auto;width:100%;margin-bottom:8px}.toast-title{font-size:.95rem}.toast-message{font-size:13px}.empty-state{padding:60px 20px}.empty-icon{font-size:3rem;margin-bottom:16px}.empty-title{font-size:1.3rem;margin-bottom:10px}.empty-message{font-size:.95rem;margin-bottom:20px}.suggestion-chip{font-size:13px;padding:10px 14px}.skeleton-card{margin-bottom:16px}.skeleton-content{padding:16px}}@media (max-width:768px){.modal-overlay{padding:10px;align-items:flex-start;padding-top:20px}.detail-modal{max-height:calc(100vh - 40px);border-radius:12px;margin:0}.detail-content{grid-template-columns:1fr;gap:20px;padding:20px}.close-btn{top:15px;right:15px;width:36px;height:36px;font-size:20px}.detail-info h2{font-size:1.4rem;margin-bottom:12px}.detail-price{font-size:1.6rem;margin-bottom:16px}.detail-stats{grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:20px}.stat-box{padding:10px}.stat-label{font-size:.8rem}.stat-value{font-size:1.1rem}.buy-section{flex-direction:column;gap:8px;margin-bottom:20px}.buy-btn,.save-btn{padding:14px;font-size:16px;border-radius:8px}.testimonials-section h3{font-size:1.2rem;margin-bottom:16px}.testimonial{padding:16px;margin-bottom:12px;border-radius:10px}.testimonial-header{flex-direction:column;align-items:flex-start;gap:10px;margin-bottom:10px}.reviewer-info{gap:10px}.reviewer-avatar{width:36px;height:36px}.reviewer-name{font-size:.95rem}.reviewer-meta{font-size:.8rem}.testimonial-text{font-size:.9rem;line-height:1.5;margin-bottom:10px}.testimonial-footer{flex-direction:column;align-items:flex-start;gap:8px}.helpful-btn{padding:8px 12px;font-size:.8rem}}@media (hover:none) and (pointer:coarse){.quick-btn:hover::before{left:0}.gift-card:hover::before{opacity:0}.gift-card:hover{transform:none;box-shadow:0 2px 8px rgba(0,0,0,.08)}.gift-card:hover img{transform:none}.recommendation-card:hover::before{left:0}.recommendation-card:hover{transform:none;border-color:transparent;box-shadow:none}.sort-btn:hover:not(.active){border-color:var(--gray-300);color:inherit}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes loading{0%{transform:translateX(-100%)}50%{transform:translateX(200%)}100%{transform:translateX(300%)}}.fade-in{animation:fadeIn .5s ease-out}</style><script defer="defer" src="/static/js/main.69b0ce09.js"></script><link href="/static/css/main.45a7795f.css" rel="stylesheet"></head><body><div id="root"></div><script src="https://unpkg.com/react@18/umd/react.development.js"></script><script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script><script>// Toast System
        let toastId = 0;
        const toastContainer = document.createElement('div');
        toastContainer.className = 'toast-container';
        document.body.appendChild(toastContainer);

        function showToast(title, message, type = 'info') {
            const toast = document.createElement('div');
            const id = ++toastId;

            const icons = {
                success: '✅',
                info: '💡',
                warning: '⚠️',
                error: '❌'
            };

            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-icon">${icons[type] || icons.info}</div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
            `;

            toastContainer.appendChild(toast);

            setTimeout(() => {
                if (toast.parentNode) {
                    toast.style.animation = 'slideInRight 0.3s ease-out reverse';
                    setTimeout(() => {
                        if (toast.parentNode) {
                            toast.parentNode.removeChild(toast);
                        }
                    }, 300);
                }
            }, 3000);
        }

        // Data URL configuration
        const DATA_URL = window.location.hostname === 'localhost'
            ? 'http://localhost:3001'
            : './full-data.json';

        const { useState, useEffect, Fragment, useRef } = React;

        // User Behavior Analytics
        class UserAnalytics {
            constructor() {
                this.data = this.loadData();
            }

            loadData() {
                const saved = localStorage.getItem('giftgenius_analytics');
                return saved ? JSON.parse(saved) : {
                    sessions: 0,
                    totalTime: 0,
                    giftViews: {},
                    searches: [],
                    categories: {},
                    priceRanges: {},
                    lastVisit: null,
                    preferences: {},
                    interactions: []
                };
            }

            saveData() {
                localStorage.setItem('giftgenius_analytics', JSON.stringify(this.data));
            }

            trackSession() {
                this.data.sessions++;
                this.data.lastVisit = Date.now();
                this.saveData();
            }

            trackGiftView(giftId, duration = 1000) {
                if (!this.data.giftViews[giftId]) {
                    this.data.giftViews[giftId] = { count: 0, totalTime: 0 };
                }
                this.data.giftViews[giftId].count++;
                this.data.giftViews[giftId].totalTime += duration;
                this.saveData();
            }

            trackSearch(query, results) {
                this.data.searches.push({
                    query,
                    results: results.length,
                    timestamp: Date.now()
                });
                this.saveData();
            }

            trackCategoryInterest(category) {
                this.data.categories[category] = (this.data.categories[category] || 0) + 1;
                this.saveData();
            }

            trackPriceInterest(price) {
                const range = this.getPriceRange(price);
                this.data.priceRanges[range] = (this.data.priceRanges[range] || 0) + 1;
                this.saveData();
            }

            getPriceRange(price) {
                if (price < 25) return 'under25';
                if (price < 50) return '25to50';
                if (price < 100) return '50to100';
                if (price < 200) return '100to200';
                return 'over200';
            }

            getPreferredCategories() {
                return Object.entries(this.data.categories)
                    .sort((a, b) => b[1] - a[1])
                    .slice(0, 3)
                    .map(([category]) => category);
            }

            getPreferredPriceRange() {
                const ranges = Object.entries(this.data.priceRanges)
                    .sort((a, b) => b[1] - a[1]);
                return ranges.length > 0 ? ranges[0][0] : 'any';
            }

            isReturningUser() {
                return this.data.sessions > 1;
            }

            getPersonalizationScore(gift) {
                let score = 0;

                // Category preference
                if (this.data.categories[gift.category]) {
                    score += this.data.categories[gift.category] * 10;
                }

                // Price preference
                const priceRange = this.getPriceRange(gift.price);
                if (this.data.priceRanges[priceRange]) {
                    score += this.data.priceRanges[priceRange] * 5;
                }

                // Previous views
                if (this.data.giftViews[gift.id]) {
                    score += this.data.giftViews[gift.id].count * 3;
                }

                return score;
            }
        }

        // Recommendation Engine
        class RecommendationEngine {
            constructor(analytics) {
                this.analytics = analytics;
            }

            getSimilarGifts(gift, allGifts, limit = 4) {
                return allGifts
                    .filter(g => g.id !== gift.id)
                    .map(g => ({
                        ...g,
                        similarity: this.calculateSimilarity(gift, g)
                    }))
                    .sort((a, b) => b.similarity - a.similarity)
                    .slice(0, limit);
            }

            calculateSimilarity(gift1, gift2) {
                let score = 0;

                // Category match
                if (gift1.category === gift2.category) score += 30;

                // Price similarity
                const priceDiff = Math.abs(gift1.price - gift2.price);
                const maxPrice = Math.max(gift1.price, gift2.price);
                if (maxPrice > 0) {
                    score += (1 - priceDiff / maxPrice) * 20;
                }

                // Success rate similarity
                const successDiff = Math.abs((gift1.successRate || 0) - (gift2.successRate || 0));
                score += (1 - successDiff / 100) * 15;

                // Testimonial similarity
                if (gift1.testimonials && gift2.testimonials) {
                    const commonWords = this.getCommonWords(
                        gift1.testimonials.map(t => t.text).join(' '),
                        gift2.testimonials.map(t => t.text).join(' ')
                    );
                    score += commonWords * 2;
                }

                return score;
            }

            getCommonWords(text1, text2) {
                const words1 = text1.toLowerCase().split(/\W+/).filter(w => w.length > 3);
                const words2 = text2.toLowerCase().split(/\W+/).filter(w => w.length > 3);
                const set1 = new Set(words1);
                const set2 = new Set(words2);
                return [...set1].filter(word => set2.has(word)).length;
            }

            getPersonalizedRecommendations(allGifts, limit = 6) {
                const preferredCategories = this.analytics.getPreferredCategories();
                const personalizedGifts = allGifts
                    .map(gift => ({
                        ...gift,
                        personalizationScore: this.analytics.getPersonalizationScore(gift)
                    }))
                    .sort((a, b) => b.personalizationScore - a.personalizationScore);

                return personalizedGifts.slice(0, limit);
            }

            getContextualRecommendations(allGifts) {
                const now = new Date();
                const month = now.getMonth();
                const dayOfYear = Math.floor((now - new Date(now.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24));

                let context = 'general';

                // Seasonal context
                if (month === 1) context = 'valentine';
                else if (month === 11) context = 'holiday';
                else if (month >= 4 && month <= 6) context = 'spring';
                else if (month >= 7 && month <= 9) context = 'summer';

                // Day-based context
                if (dayOfYear % 7 === 0) context = 'weekend';

                const contextualFilters = {
                    valentine: gift => gift.category === 'jewelry' || gift.name?.toLowerCase().includes('romantic'),
                    holiday: gift => gift.category === 'home' || gift.name?.toLowerCase().includes('cozy'),
                    spring: gift => gift.category === 'experiences' || gift.category === 'fashion',
                    summer: gift => gift.category === 'experiences' || gift.name?.toLowerCase().includes('outdoor'),
                    weekend: gift => gift.category === 'experiences',
                    general: () => true
                };

                const filter = contextualFilters[context] || contextualFilters.general;
                return allGifts.filter(filter).slice(0, 4);
            }

            getTrendingGifts(allGifts) {
                // Simulate trending based on success rate and recent activity
                return allGifts
                    .filter(gift => gift.successRate > 85)
                    .sort((a, b) => {
                        const aScore = (a.successRate || 0) + Math.random() * 10;
                        const bScore = (b.successRate || 0) + Math.random() * 10;
                        return bScore - aScore;
                    })
                    .slice(0, 3);
            }
        }

        // Social Proof Manager
        class SocialProofManager {
            constructor() {
                this.activities = [];
                this.lastUpdate = 0;
            }

            generateRealtimeActivity(gifts) {
                const now = Date.now();
                if (now - this.lastUpdate < 5000) return; // Update every 5 seconds

                const activities = [
                    'just bought this',
                    'saved to favorites',
                    'viewed details',
                    'shared with partner',
                    'added to wishlist'
                ];

                const locations = ['NYC', 'LA', 'Chicago', 'Miami', 'Seattle', 'Denver', 'Austin'];
                const names = ['Alex', 'Jamie', 'Chris', 'Sam', 'Jordan', 'Casey', 'Taylor'];

                if (gifts.length > 0) {
                    const randomGift = gifts[Math.floor(Math.random() * gifts.length)];
                    const activity = activities[Math.floor(Math.random() * activities.length)];
                    const location = locations[Math.floor(Math.random() * locations.length)];
                    const name = names[Math.floor(Math.random() * names.length)];

                    this.activities.unshift({
                        id: Date.now(),
                        text: `${name} from ${location} ${activity}`,
                        gift: randomGift.name || randomGift.title,
                        timestamp: now,
                        type: activity.includes('bought') ? 'purchase' : 'interaction'
                    });

                    // Keep only last 5 activities
                    this.activities = this.activities.slice(0, 5);
                    this.lastUpdate = now;
                }
            }

            getActivities() {
                return this.activities;
            }

            getViewerCount(giftId) {
                // Simulate current viewers
                return Math.floor(Math.random() * 8) + 1;
            }

            getPurchaseCount(giftId) {
                // Simulate recent purchases
                return Math.floor(Math.random() * 15) + 5;
            }
        }

        function App() {
            const [gifts, setGifts] = useState([]);
            const [allGifts, setAllGifts] = useState([]);
            const [selectedGift, setSelectedGift] = useState(null);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const [favorites, setFavorites] = useState([]);
            const [sortBy, setSortBy] = useState('personalized');
            const [searchSuggestions, setSearchSuggestions] = useState([]);
            const [showSuggestions, setShowSuggestions] = useState(false);
            const [selectedSuggestion, setSelectedSuggestion] = useState(-1);
            const searchRef = useRef(null);

            // Phase 2: Intelligence & Personalization (initialized lazily)
            const [analytics, setAnalytics] = useState(null);
            const [recommendationEngine, setRecommendationEngine] = useState(null);
            const [socialProof, setSocialProof] = useState(null);
            const [personalizedGifts, setPersonalizedGifts] = useState([]);
            const [similarGifts, setSimilarGifts] = useState([]);
            const [contextualGifts, setContextualGifts] = useState([]);
            const [trendingGifts, setTrendingGifts] = useState([]);
            const [activities, setActivities] = useState([]);
            const [userProfile, setUserProfile] = useState({});

            const [filter, setFilter] = useState({
                category: '',
                maxPrice: 1000,
                minSuccessRate: 0,
                search: '',
                quickFilter: ''
            });

            // Quick recommendation scenarios
            const quickScenarios = [
                { id: 'anniversary', emoji: '💑', label: 'Anniversary', desc: 'Romantic & meaningful', filter: { category: 'jewelry', minSuccessRate: 90 } },
                { id: 'birthday', emoji: '🎂', label: 'Birthday', desc: 'Personal & special', filter: { category: '', minSuccessRate: 80 } },
                { id: 'justbecause', emoji: '💝', label: 'Just Because', desc: 'Thoughtful surprise', filter: { maxPrice: 100 } },
                { id: 'apology', emoji: '🙏', label: 'Apology Gift', desc: 'Make things right', filter: { minSuccessRate: 95 } },
                { id: 'holiday', emoji: '🎄', label: 'Holiday', desc: 'Festive & cozy', filter: { category: 'home' } },
                { id: 'firstdate', emoji: '🌹', label: 'New Relationship', desc: 'Not too much', filter: { maxPrice: 50 } }
            ];

            // Initialize analytics lazily after first render
            useEffect(() => {
                if (!analytics) {
                    const analyticsInstance = new UserAnalytics();
                    const recommendationEngineInstance = new RecommendationEngine(analyticsInstance);
                    const socialProofInstance = new SocialProofManager();

                    setAnalytics(analyticsInstance);
                    setRecommendationEngine(recommendationEngineInstance);
                    setSocialProof(socialProofInstance);

                    analyticsInstance.trackSession();
                }
            }, []);

            useEffect(() => {
                fetchGifts();
                loadFavorites();
            }, []);

            useEffect(() => {
                filterAndSortGifts();
                if (analytics && recommendationEngine && allGifts.length > 0) {
                    updateRecommendations();
                }
            }, [filter, sortBy, allGifts, analytics, recommendationEngine]);

            useEffect(() => {
                if (filter.search) {
                    generateSearchSuggestions(filter.search);
                    if (analytics) {
                        analytics.trackSearch(filter.search, gifts);
                    }
                } else {
                    setSearchSuggestions([]);
                    setShowSuggestions(false);
                }
            }, [filter.search, allGifts, analytics]);

            // Start activity updates only after everything is loaded
            useEffect(() => {
                if (socialProof && allGifts.length > 0) {
                    const activityInterval = setInterval(() => {
                        socialProof.generateRealtimeActivity(allGifts);
                        setActivities([...socialProof.getActivities()]);
                    }, 8000);

                    return () => clearInterval(activityInterval);
                }
            }, [socialProof, allGifts]);

            const updateRecommendations = () => {
                if (allGifts.length === 0) return;

                setPersonalizedGifts(recommendationEngine.getPersonalizedRecommendations(allGifts));
                setContextualGifts(recommendationEngine.getContextualRecommendations(allGifts));
                setTrendingGifts(recommendationEngine.getTrendingGifts(allGifts));

                setUserProfile({
                    isReturning: analytics.isReturningUser(),
                    sessions: analytics.data.sessions,
                    preferredCategories: analytics.getPreferredCategories(),
                    preferredPriceRange: analytics.getPreferredPriceRange()
                });
            };

            const loadFavorites = () => {
                const saved = localStorage.getItem('favorites');
                if (saved) setFavorites(JSON.parse(saved));
            };

            const toggleFavorite = (giftId) => {
                const newFavorites = favorites.includes(giftId)
                    ? favorites.filter(id => id !== giftId)
                    : [...favorites, giftId];
                setFavorites(newFavorites);
                localStorage.setItem('favorites', JSON.stringify(newFavorites));

                showToast(
                    favorites.includes(giftId) ? 'Removed from Favorites' : 'Added to Favorites',
                    favorites.includes(giftId) ? 'Gift removed from your saved list' : 'Gift saved to your favorites',
                    'success'
                );
            };

            const handleGiftClick = (gift) => {
                analytics.trackGiftView(gift.id);
                analytics.trackCategoryInterest(gift.category);
                analytics.trackPriceInterest(gift.price);

                const similar = recommendationEngine.getSimilarGifts(gift, allGifts);
                setSimilarGifts(similar);
                setSelectedGift(gift);

                showToast(
                    'Gift Details',
                    `Viewing ${gift.name || gift.title}`,
                    'info'
                );
            };

            const generateSearchSuggestions = (query) => {
                if (!query || query.length < 2) {
                    setSearchSuggestions([]);
                    return;
                }

                const lowerQuery = query.toLowerCase();
                const suggestions = [];

                // Gift name suggestions
                allGifts.forEach(gift => {
                    if ((gift.name && gift.name.toLowerCase().includes(lowerQuery)) ||
                        (gift.title && gift.title.toLowerCase().includes(lowerQuery))) {
                        suggestions.push({
                            type: 'gift',
                            text: gift.name || gift.title,
                            icon: '🎁',
                            category: gift.category,
                            id: gift.id
                        });
                    }
                });

                // Category suggestions
                const categories = ['jewelry', 'experiences', 'home', 'fashion', 'beauty', 'tech', 'unique'];
                categories.forEach(cat => {
                    if (cat.includes(lowerQuery)) {
                        suggestions.push({
                            type: 'category',
                            text: cat.charAt(0).toUpperCase() + cat.slice(1),
                            icon: getCategoryIcon(cat),
                            category: cat
                        });
                    }
                });

                // AI-powered suggestions based on user behavior
                if (analytics.isReturningUser()) {
                    const preferredCategories = analytics.getPreferredCategories();
                    preferredCategories.forEach(cat => {
                        if (cat.includes(lowerQuery)) {
                            suggestions.push({
                                type: 'ai',
                                text: `${cat} (Your favorite)`,
                                icon: '🤖',
                                category: cat
                            });
                        }
                    });
                }

                setSearchSuggestions(suggestions.slice(0, 8));
                setShowSuggestions(true);
                setSelectedSuggestion(-1);
            };

            const getCategoryIcon = (category) => {
                const icons = {
                    jewelry: '💎',
                    experiences: '🎭',
                    home: '🏠',
                    fashion: '👗',
                    beauty: '💄',
                    tech: '📱',
                    unique: '✨'
                };
                return icons[category] || '🎁';
            };

            const handleSearchKeyDown = (e) => {
                if (!showSuggestions || searchSuggestions.length === 0) return;

                switch (e.key) {
                    case 'ArrowDown':
                        e.preventDefault();
                        setSelectedSuggestion(prev =>
                            prev < searchSuggestions.length - 1 ? prev + 1 : 0
                        );
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        setSelectedSuggestion(prev =>
                            prev > 0 ? prev - 1 : searchSuggestions.length - 1
                        );
                        break;
                    case 'Enter':
                        e.preventDefault();
                        if (selectedSuggestion >= 0) {
                            selectSuggestion(searchSuggestions[selectedSuggestion]);
                        }
                        break;
                    case 'Escape':
                        setShowSuggestions(false);
                        setSelectedSuggestion(-1);
                        break;
                }
            };

            const selectSuggestion = (suggestion) => {
                if (suggestion.type === 'category' || suggestion.type === 'ai') {
                    setFilter(prev => ({ ...prev, category: suggestion.category, search: '' }));
                } else if (suggestion.type === 'gift') {
                    setFilter(prev => ({ ...prev, search: suggestion.text }));
                } else {
                    setFilter(prev => ({ ...prev, search: suggestion.text }));
                }
                setShowSuggestions(false);
                setSelectedSuggestion(-1);
            };

            const fetchGifts = async () => {
                setLoading(true);
                setError(null);

                try {
                    console.log('Fetching gifts from:', DATA_URL);

                    // Add timeout to prevent hanging
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 second timeout

                    const response = await fetch(DATA_URL, {
                        signal: controller.signal,
                        cache: 'no-cache'
                    });

                    clearTimeout(timeoutId);

                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }

                    const data = await response.json();
                    console.log('Data loaded:', data);

                    const giftsData = data.gifts || data || [];

                    if (!Array.isArray(giftsData) || giftsData.length === 0) {
                        throw new Error('No gifts data found');
                    }

                    setAllGifts(giftsData);
                    setGifts(giftsData);

                    // Generate initial social proof only if socialProof is available
                    if (socialProof) {
                        socialProof.generateRealtimeActivity(giftsData);
                        setActivities([...socialProof.getActivities()]);
                    }

                    showToast(
                        'Gifts Loaded!',
                        `Found ${giftsData.length} amazing gifts for you`,
                        'success'
                    );

                    console.log('Successfully loaded', giftsData.length, 'gifts');

                } catch (error) {
                    console.error('Error fetching gifts:', error);

                    // Fallback to sample data if fetch fails
                    const fallbackGifts = [
                        {
                            id: 1,
                            name: "Sample Gift 1",
                            title: "Sample Gift 1",
                            price: 50,
                            category: "jewelry",
                            successRate: 95,
                            image: "https://via.placeholder.com/300x200/6B46C1/FFFFFF?text=Gift",
                            testimonials: [
                                { text: "Great gift!", reviewer: "John", relationship: "Boyfriend" }
                            ]
                        },
                        {
                            id: 2,
                            name: "Sample Gift 2",
                            title: "Sample Gift 2",
                            price: 75,
                            category: "experiences",
                            successRate: 90,
                            image: "https://via.placeholder.com/300x200/6B46C1/FFFFFF?text=Gift",
                            testimonials: [
                                { text: "She loved it!", reviewer: "Mike", relationship: "Husband" }
                            ]
                        }
                    ];

                    setAllGifts(fallbackGifts);
                    setGifts(fallbackGifts);

                    setError(`Loading error: ${error.message}. Using sample data.`);
                    showToast(
                        'Loading Issue',
                        'Using sample data. Please refresh to try again.',
                        'warning'
                    );
                } finally {
                    setLoading(false);
                }
            };

            const filterAndSortGifts = () => {
                let filtered = allGifts.filter(gift => {
                    if (filter.category && gift.category !== filter.category) return false;
                    if (gift.price > filter.maxPrice) return false;
                    if ((gift.successRate || 0) < filter.minSuccessRate) return false;
                    if (filter.search &&
                        !gift.name?.toLowerCase().includes(filter.search.toLowerCase()) &&
                        !gift.title?.toLowerCase().includes(filter.search.toLowerCase()) &&
                        !gift.category?.toLowerCase().includes(filter.search.toLowerCase())) {
                        return false;
                    }
                    return true;
                });

                // Apply quick filter
                if (filter.quickFilter) {
                    const scenario = quickScenarios.find(s => s.id === filter.quickFilter);
                    if (scenario) {
                        Object.entries(scenario.filter).forEach(([key, value]) => {
                            if (key === 'category' && value) {
                                filtered = filtered.filter(gift => gift.category === value);
                            } else if (key === 'maxPrice') {
                                filtered = filtered.filter(gift => gift.price <= value);
                            } else if (key === 'minSuccessRate') {
                                filtered = filtered.filter(gift => (gift.successRate || 0) >= value);
                            }
                        });
                    }
                }

                // Sort gifts
                filtered.sort((a, b) => {
                    switch (sortBy) {
                        case 'personalized':
                            const aScore = analytics.getPersonalizationScore(a);
                            const bScore = analytics.getPersonalizationScore(b);
                            if (aScore !== bScore) return bScore - aScore;
                            return (b.successRate || 0) - (a.successRate || 0);
                        case 'popular':
                            return (b.successRate || 0) - (a.successRate || 0);
                        case 'price-low':
                            return a.price - b.price;
                        case 'price-high':
                            return b.price - a.price;
                        case 'newest':
                            return (b.id || 0) - (a.id || 0);
                        default:
                            return 0;
                    }
                });

                setGifts(filtered);
            };

            const clearFilters = () => {
                setFilter({
                    category: '',
                    maxPrice: 1000,
                    minSuccessRate: 0,
                    search: '',
                    quickFilter: ''
                });
                setSortBy('personalized');
                showToast('Filters Cleared', 'All filters have been reset', 'info');
            };

            const handleQuickFilter = (scenarioId) => {
                const isActive = filter.quickFilter === scenarioId;
                setFilter(prev => ({
                    ...prev,
                    quickFilter: isActive ? '' : scenarioId
                }));

                if (!isActive) {
                    const scenario = quickScenarios.find(s => s.id === scenarioId);
                    showToast(
                        `${scenario.label} Selected`,
                        `Showing gifts perfect for ${scenario.desc.toLowerCase()}`,
                        'info'
                    );
                }
            };

            const getActiveFilters = () => {
                const active = [];
                if (filter.category) active.push({ key: 'category', value: filter.category, label: filter.category });
                if (filter.maxPrice < 1000) active.push({ key: 'maxPrice', value: filter.maxPrice, label: `Under $${filter.maxPrice}` });
                if (filter.minSuccessRate > 0) active.push({ key: 'minSuccessRate', value: filter.minSuccessRate, label: `${filter.minSuccessRate}%+ Success` });
                if (filter.search) active.push({ key: 'search', value: filter.search, label: `"${filter.search}"` });
                if (filter.quickFilter) {
                    const scenario = quickScenarios.find(s => s.id === filter.quickFilter);
                    if (scenario) active.push({ key: 'quickFilter', value: filter.quickFilter, label: scenario.label });
                }
                return active;
            };

            const removeFilter = (key) => {
                setFilter(prev => ({
                    ...prev,
                    [key]: key === 'maxPrice' ? 1000 : key === 'minSuccessRate' ? 0 : ''
                }));
            };

            const renderGiftBadge = (gift) => {
                const badges = [];

                if ((gift.successRate || 0) >= 95) {
                    badges.push({ text: 'Hot', class: 'hot' });
                } else if ((gift.successRate || 0) >= 90) {
                    badges.push({ text: 'Top Pick', class: '' });
                }

                if (trendingGifts.some(tg => tg.id === gift.id)) {
                    badges.push({ text: 'Trending', class: 'trending' });
                }

                if (personalizedGifts.some(pg => pg.id === gift.id)) {
                    badges.push({ text: 'For You', class: 'ai-recommended' });
                }

                return badges.length > 0 ? badges[0] : null;
            };

            const getTimeAgo = (timestamp) => {
                const seconds = Math.floor((Date.now() - timestamp) / 1000);
                if (seconds < 60) return 'just now';
                if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;
                if (seconds < 86400) return `${Math.floor(seconds / 3600)}h ago`;
                return `${Math.floor(seconds / 86400)}d ago`;
            };

            if (loading) {
                return (
                    <div className="app-container">
                        {/* Hero Section */}
                        <section className="hero">
                            <div className="container">
                                <h1>🎁 GiftGenius</h1>
                                <p>Find the perfect gift backed by real testimonials from men who got it right</p>
                                <div className="trust-indicators">
                                    <div className="trust-indicator">
                                        <span>⭐</span>
                                        <span>96% Success Rate</span>
                                    </div>
                                    <div className="trust-indicator">
                                        <span>❤️</span>
                                        <span>1,200+ Happy Partners</span>
                                    </div>
                                    <div className="trust-indicator">
                                        <span>🏆</span>
                                        <span>Expert Curated</span>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <div className="container">
                            <div style={{
                                textAlign: 'center',
                                padding: '40px 20px',
                                background: 'var(--gray-50)',
                                borderRadius: '16px',
                                marginBottom: '30px'
                            }}>
                                <div style={{
                                    fontSize: '3rem',
                                    marginBottom: '20px',
                                    animation: 'pulse 2s infinite'
                                }}>🎁</div>
                                <h2 style={{ color: 'var(--primary)', marginBottom: '10px' }}>
                                    Loading Amazing Gifts...
                                </h2>
                                <p style={{ color: 'var(--gray-600)' }}>
                                    Curating the perfect selection for you
                                </p>
                                <div style={{
                                    width: '200px',
                                    height: '4px',
                                    background: 'var(--gray-200)',
                                    borderRadius: '2px',
                                    margin: '20px auto',
                                    overflow: 'hidden'
                                }}>
                                    <div style={{
                                        width: '50%',
                                        height: '100%',
                                        background: 'linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%)',
                                        borderRadius: '2px',
                                        animation: 'loading 2s ease-in-out infinite'
                                    }}></div>
                                </div>
                            </div>

                            <div className="gift-grid">
                                {[1, 2, 3, 4, 5, 6].map(i => (
                                    <div key={i} className="skeleton-card">
                                        <div className="skeleton skeleton-image"></div>
                                        <div className="skeleton-content">
                                            <div className="skeleton skeleton-title"></div>
                                            <div className="skeleton skeleton-price"></div>
                                            <div className="skeleton skeleton-rating"></div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <style jsx>{`
                            @keyframes loading {
                                0% { transform: translateX(-100%); }
                                50% { transform: translateX(200%); }
                                100% { transform: translateX(300%); }
                            }
                        `}</style>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="app-container">
                        <div className="container">
                            <div className="empty-state">
                                <div className="empty-icon">😔</div>
                                <h2 className="empty-title">Oops! Something went wrong</h2>
                                <p className="empty-message">{error}</p>
                                <button onClick={fetchGifts} className="suggestion-chip">
                                    Try Again
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="app-container">
                    {/* Hero Section */}
                    <section className="hero">
                        <div className="container">
                            <h1>🎁 GiftGenius</h1>
                            <p>Find the perfect gift backed by real testimonials from men who got it right</p>
                            <div className="trust-indicators">
                                <div className="trust-indicator">
                                    <span>⭐</span>
                                    <span>96% Success Rate</span>
                                </div>
                                <div className="trust-indicator">
                                    <span>❤️</span>
                                    <span>1,200+ Happy Partners</span>
                                </div>
                                <div className="trust-indicator">
                                    <span>🏆</span>
                                    <span>Expert Curated</span>
                                </div>
                            </div>
                        </div>
                    </section>

                    <div className="container">
                        {/* Personalization Banner */}
                        {analytics.isReturningUser() && (
                            <div className="personalization-banner">
                                <div className="personalization-content">
                                    <div className="personalization-icon">👋</div>
                                    <div className="personalization-text">
                                        <h3>Welcome back!</h3>
                                        <p>We've learned your preferences and found some great new picks for you</p>
                                    </div>
                                    <div className="activity-counter">
                                        Visit #{userProfile.sessions}
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Social Proof Activity Feed */}
                        {activities.length > 0 && (
                            <div className="activity-feed">
                                <h3 style={{marginBottom: '15px', color: 'var(--gray-700)', fontSize: '1rem'}}>
                                    🔥 Real-time Activity
                                </h3>
                                {activities.slice(0, 3).map(activity => (
                                    <div key={activity.id} className="activity-item">
                                        <div className="activity-avatar">
                                            {activity.text.charAt(0)}
                                        </div>
                                        <div className="activity-text">
                                            {activity.text}: <strong>{activity.gift}</strong>
                                        </div>
                                        <div className="activity-time">
                                            {getTimeAgo(activity.timestamp)}
                                        </div>
                                        {activity.type === 'purchase' && (
                                            <div className="trending-indicator">HOT</div>
                                        )}
                                    </div>
                                ))}
                            </div>
                        )}

                        {/* Smart Recommendations */}
                        {(personalizedGifts.length > 0 || contextualGifts.length > 0 || trendingGifts.length > 0) && (
                            <div className="smart-recommendations">
                                <h3>🤖 Smart Recommendations</h3>

                                {personalizedGifts.length > 0 && (
                                    <div className="recommendation-section">
                                        <div className="recommendation-title">
                                            ⭐ Perfect for You
                                        </div>
                                        <div className="recommendation-grid">
                                            {personalizedGifts.slice(0, 3).map(gift => (
                                                <div
                                                    key={gift.id}
                                                    className="recommendation-card"
                                                    onClick={() => handleGiftClick(gift)}
                                                >
                                                    <div className="recommendation-reason">AI MATCH</div>
                                                    <div className="recommendation-name">{gift.name || gift.title}</div>
                                                    <div className="recommendation-match">
                                                        Based on your preferences
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {contextualGifts.length > 0 && (
                                    <div className="recommendation-section">
                                        <div className="recommendation-title">
                                            🌟 Trending Now
                                        </div>
                                        <div className="recommendation-grid">
                                            {contextualGifts.slice(0, 3).map(gift => (
                                                <div
                                                    key={gift.id}
                                                    className="recommendation-card"
                                                    onClick={() => handleGiftClick(gift)}
                                                >
                                                    <div className="recommendation-reason">SEASONAL</div>
                                                    <div className="recommendation-name">{gift.name || gift.title}</div>
                                                    <div className="recommendation-match">
                                                        Perfect for this time of year
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                {trendingGifts.length > 0 && (
                                    <div className="recommendation-section">
                                        <div className="recommendation-title">
                                            🔥 Hot Right Now
                                        </div>
                                        <div className="recommendation-grid">
                                            {trendingGifts.map(gift => (
                                                <div
                                                    key={gift.id}
                                                    className="recommendation-card"
                                                    onClick={() => handleGiftClick(gift)}
                                                >
                                                    <div className="recommendation-reason">TRENDING</div>
                                                    <div className="recommendation-name">{gift.name || gift.title}</div>
                                                    <div className="recommendation-match">
                                                        {gift.successRate || 90}% success rate
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Quick Recommendations */}
                        <div className="quick-recs">
                            <h2>What's the occasion?</h2>
                            <div className="quick-buttons">
                                {quickScenarios.map(scenario => (
                                    <button
                                        key={scenario.id}
                                        className={`quick-btn ${filter.quickFilter === scenario.id ? 'active' : ''}`}
                                        onClick={() => handleQuickFilter(scenario.id)}
                                    >
                                        <span className="emoji">{scenario.emoji}</span>
                                        <div>
                                            <div className="label">{scenario.label}</div>
                                            <div className="desc">{scenario.desc}</div>
                                        </div>
                                    </button>
                                ))}
                            </div>
                        </div>

                        {/* Filters */}
                        <div className="filters">
                            <div className="search-container">
                                <input
                                    ref={searchRef}
                                    type="text"
                                    className="search-input"
                                    placeholder="Search gifts, categories, or occasions..."
                                    value={filter.search}
                                    onChange={(e) => setFilter(prev => ({ ...prev, search: e.target.value }))}
                                    onKeyDown={handleSearchKeyDown}
                                    onFocus={() => filter.search && setShowSuggestions(true)}
                                    onBlur={() => setTimeout(() => setShowSuggestions(false), 200)}
                                />

                                {showSuggestions && searchSuggestions.length > 0 && (
                                    <div className="search-suggestions">
                                        {searchSuggestions.map((suggestion, index) => (
                                            <div
                                                key={index}
                                                className={`suggestion-item ${index === selectedSuggestion ? 'active' : ''}`}
                                                onClick={() => selectSuggestion(suggestion)}
                                            >
                                                <span className="suggestion-icon">{suggestion.icon}</span>
                                                <span className="suggestion-text">{suggestion.text}</span>
                                                <span className="suggestion-category">{suggestion.type}</span>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>

                            <select
                                value={filter.category}
                                onChange={(e) => setFilter(prev => ({ ...prev, category: e.target.value }))}
                            >
                                <option value="">All Categories</option>
                                <option value="jewelry">💎 Jewelry</option>
                                <option value="experiences">🎭 Experiences</option>
                                <option value="home">🏠 Home & Living</option>
                                <option value="fashion">👗 Fashion</option>
                                <option value="beauty">💄 Beauty</option>
                                <option value="tech">📱 Tech</option>
                                <option value="unique">✨ Unique</option>
                            </select>

                            <input
                                type="range"
                                min="25"
                                max="1000"
                                value={filter.maxPrice}
                                onChange={(e) => setFilter(prev => ({ ...prev, maxPrice: parseInt(e.target.value) }))}
                                style={{ minWidth: '120px' }}
                            />
                            <span style={{ fontSize: '14px', color: 'var(--gray-600)' }}>
                                Under ${filter.maxPrice}
                            </span>

                            <select
                                value={filter.minSuccessRate}
                                onChange={(e) => setFilter(prev => ({ ...prev, minSuccessRate: parseInt(e.target.value) }))}
                            >
                                <option value={0}>Any Success Rate</option>
                                <option value={80}>80%+ Success</option>
                                <option value={90}>90%+ Success</option>
                                <option value={95}>95%+ Success</option>
                            </select>

                            <button className="clear-filters" onClick={clearFilters}>
                                Clear All
                            </button>
                        </div>

                        {/* Active Filters */}
                        {getActiveFilters().length > 0 && (
                            <div className="active-filters">
                                {getActiveFilters().map(filter => (
                                    <div key={filter.key} className="filter-badge">
                                        {filter.label}
                                        <span
                                            className="filter-badge-remove"
                                            onClick={() => removeFilter(filter.key)}
                                        >
                                            ×
                                        </span>
                                    </div>
                                ))}
                            </div>
                        )}

                        {/* Results Summary */}
                        <div className="results-summary">
                            <div className="results-count">
                                {gifts.length} {gifts.length === 1 ? 'gift' : 'gifts'} found
                            </div>
                            <div className="sort-options">
                                <button
                                    className={`sort-btn ${sortBy === 'personalized' ? 'active' : ''}`}
                                    onClick={() => setSortBy('personalized')}
                                >
                                    🤖 For You
                                </button>
                                <button
                                    className={`sort-btn ${sortBy === 'popular' ? 'active' : ''}`}
                                    onClick={() => setSortBy('popular')}
                                >
                                    ⭐ Most Popular
                                </button>
                                <button
                                    className={`sort-btn ${sortBy === 'price-low' ? 'active' : ''}`}
                                    onClick={() => setSortBy('price-low')}
                                >
                                    💰 Price: Low to High
                                </button>
                                <button
                                    className={`sort-btn ${sortBy === 'price-high' ? 'active' : ''}`}
                                    onClick={() => setSortBy('price-high')}
                                >
                                    💎 Price: High to Low
                                </button>
                            </div>
                        </div>

                        {/* Gift Grid */}
                        {gifts.length === 0 ? (
                            <div className="empty-state">
                                <div className="empty-icon">🔍</div>
                                <h2 className="empty-title">No gifts found</h2>
                                <p className="empty-message">
                                    Try adjusting your filters or explore our popular categories
                                </p>
                                <div className="empty-suggestions">
                                    <span className="suggestion-chip" onClick={() => setFilter(prev => ({ ...prev, category: 'jewelry' }))}>
                                        💎 Jewelry
                                    </span>
                                    <span className="suggestion-chip" onClick={() => setFilter(prev => ({ ...prev, category: 'experiences' }))}>
                                        🎭 Experiences
                                    </span>
                                    <span className="suggestion-chip" onClick={() => setFilter(prev => ({ ...prev, maxPrice: 100 }))}>
                                        💰 Under $100
                                    </span>
                                </div>
                            </div>
                        ) : (
                            <div className="gift-grid">
                                {gifts.map(gift => {
                                    const badge = renderGiftBadge(gift);
                                    const personalizationScore = analytics.getPersonalizationScore(gift);

                                    return (
                                        <div
                                            key={gift.id}
                                            className="gift-card fade-in"
                                            onClick={() => handleGiftClick(gift)}
                                        >
                                            <div style={{ position: 'relative' }}>
                                                <img
                                                    src={gift.image || 'https://via.placeholder.com/300x200/6B46C1/FFFFFF?text=Gift'}
                                                    alt={gift.name || gift.title}
                                                    loading="lazy"
                                                />
                                                {badge && (
                                                    <span className={`gift-badge ${badge.class}`}>
                                                        {badge.text}
                                                    </span>
                                                )}
                                            </div>
                                            <div className="gift-card-content">
                                                <h3>{gift.name || gift.title}</h3>
                                                <div className="price-row">
                                                    <span className="price">${gift.price}</span>
                                                    <span className="delivery">Free shipping</span>
                                                </div>
                                                <div className="rating-row">
                                                    <div className="hearts">
                                                        {[1,2,3,4,5].map(i => (
                                                            <span key={i} style={{
                                                                color: i <= Math.floor((gift.successRate || 0) / 20) ? '#ef4444' : '#e5e7eb'
                                                            }}>❤️</span>
                                                        ))}
                                                    </div>
                                                    <span className="success-text">
                                                        {gift.successRate || Math.floor(Math.random() * 15 + 85)}% success rate
                                                    </span>
                                                </div>
                                                {gift.testimonials && gift.testimonials[0] && (
                                                    <div className="testimonial-preview">
                                                        "{gift.testimonials[0].text?.substring(0, 100)}..."
                                                    </div>
                                                )}
                                                {personalizationScore > 20 && (
                                                    <div className="ai-insight">
                                                        🤖 Great match based on your preferences
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        )}
                    </div>

                    {/* Gift Detail Modal (keeping existing functionality but enhanced) */}
                    {selectedGift && (
                        <div className="modal-overlay" onClick={() => setSelectedGift(null)}>
                            <div className="detail-modal" onClick={(e) => e.stopPropagation()}>
                                <button className="close-btn" onClick={() => setSelectedGift(null)}>
                                    ×
                                </button>
                                <div className="detail-content">
                                    <div className="detail-image">
                                        <img src={selectedGift.image || 'https://via.placeholder.com/400x300/6B46C1/FFFFFF?text=Gift'} alt={selectedGift.name || selectedGift.title} />
                                    </div>
                                    <div className="detail-info">
                                        <h2>{selectedGift.name || selectedGift.title}</h2>
                                        <div className="detail-price">${selectedGift.price}</div>

                                        <div className="detail-stats">
                                            <div className="stat-box">
                                                <div className="stat-label">Success Rate</div>
                                                <div className="stat-value">{selectedGift.successRate || 90}%</div>
                                            </div>
                                            <div className="stat-box">
                                                <div className="stat-label">Currently Viewing</div>
                                                <div className="stat-value">{socialProof.getViewerCount(selectedGift.id)}</div>
                                            </div>
                                            <div className="stat-box">
                                                <div className="stat-label">Recent Purchases</div>
                                                <div className="stat-value">{socialProof.getPurchaseCount(selectedGift.id)}</div>
                                            </div>
                                            <div className="stat-box">
                                                <div className="stat-label">Testimonials</div>
                                                <div className="stat-value">{selectedGift.testimonials?.length || 0}</div>
                                            </div>
                                        </div>

                                        <div className="buy-section">
                                            <a
                                                href={selectedGift.buyLink || selectedGift.link || '#'}
                                                target="_blank"
                                                rel="noopener noreferrer"
                                                className="buy-btn"
                                                onClick={() => showToast('Redirecting...', 'Taking you to purchase this gift', 'info')}
                                            >
                                                Buy Now
                                            </a>
                                            <button
                                                className="save-btn"
                                                onClick={() => toggleFavorite(selectedGift.id)}
                                            >
                                                {favorites.includes(selectedGift.id) ? '❤️ Saved' : '🤍 Save'}
                                            </button>
                                        </div>

                                        {similarGifts.length > 0 && (
                                            <div style={{marginTop: '25px'}}>
                                                <h3 style={{marginBottom: '15px', color: 'var(--primary)'}}>Similar Gifts</h3>
                                                <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '12px'}}>
                                                    {similarGifts.map(similar => (
                                                        <div
                                                            key={similar.id}
                                                            style={{
                                                                background: 'var(--gray-50)',
                                                                padding: '12px',
                                                                borderRadius: '8px',
                                                                cursor: 'pointer',
                                                                fontSize: '14px'
                                                            }}
                                                            onClick={() => setSelectedGift(similar)}
                                                        >
                                                            <strong>{similar.name || similar.title}</strong>
                                                            <div style={{color: 'var(--gray-600)', marginTop: '4px'}}>
                                                                ${similar.price} • {Math.round(similar.similarity)}% match
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        )}

                                        {selectedGift.testimonials && selectedGift.testimonials.length > 0 && (
                                            <div className="testimonials-section">
                                                <h3>What Men Are Saying</h3>
                                                {selectedGift.testimonials.slice(0, 3).map((testimonial, index) => (
                                                    <div key={index} className="testimonial">
                                                        <div className="testimonial-header">
                                                            <div className="reviewer-info">
                                                                <div className="reviewer-avatar">
                                                                    {testimonial.reviewer?.charAt(0) || 'A'}
                                                                </div>
                                                                <div>
                                                                    <div className="reviewer-name">
                                                                        {testimonial.reviewer || 'Anonymous'}
                                                                    </div>
                                                                    <div className="reviewer-meta">
                                                                        {testimonial.relationship || 'Verified Purchase'}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div className="star-rating">
                                                                {[1,2,3,4,5].map(i => (
                                                                    <span key={i} className="star">⭐</span>
                                                                ))}
                                                            </div>
                                                        </div>
                                                        <div className="testimonial-text">
                                                            {testimonial.text}
                                                        </div>
                                                        <div className="testimonial-footer">
                                                            <button className="helpful-btn">
                                                                👍 Helpful ({Math.floor(Math.random() * 20 + 5)})
                                                            </button>
                                                            <span style={{fontSize: '12px', color: 'var(--gray-500)'}}>
                                                                {Math.floor(Math.random() * 30 + 1)} days ago
                                                            </span>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);

        // Register Service Worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);

                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // Show update notification
                                    showUpdateNotification();
                                }
                            });
                        });
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent the mini-infobar from appearing
            e.preventDefault();
            deferredPrompt = e;

            // Show custom install button after user interaction
            setTimeout(() => {
                showInstallPrompt();
            }, 30000); // Show after 30 seconds
        });

        function showInstallPrompt() {
            if (!deferredPrompt) return;

            const installBanner = document.createElement('div');
            installBanner.style.cssText = `
                position: fixed; bottom: 20px; left: 20px; right: 20px; z-index: 10000;
                background: linear-gradient(135deg, #6B46C1, #8B5CF6); color: white;
                padding: 16px 20px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                display: flex; align-items: center; justify-content: space-between; animation: slideUp 0.3s ease;
            `;
            installBanner.innerHTML = `
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span style="font-size: 24px;">📱</span>
                    <div>
                        <div style="font-weight: 600; margin-bottom: 4px;">Install GiftGenius</div>
                        <div style="font-size: 14px; opacity: 0.9;">Quick access to perfect gifts anytime</div>
                    </div>
                </div>
                <div style="display: flex; gap: 8px;">
                    <button id="installBtn" style="padding: 8px 16px; background: rgba(255,255,255,0.2); border: none; border-radius: 8px; color: white; cursor: pointer; font-weight: 500;">Install</button>
                    <button id="dismissBtn" style="padding: 8px 12px; background: none; border: none; color: white; cursor: pointer; font-size: 18px;">✕</button>
                </div>
            `;

            document.body.appendChild(installBanner);

            document.getElementById('installBtn').addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log(`User response to install prompt: ${outcome}`);
                    deferredPrompt = null;
                }
                installBanner.remove();
            });

            document.getElementById('dismissBtn').addEventListener('click', () => {
                installBanner.remove();
                deferredPrompt = null;
            });
        }

        function showUpdateNotification() {
            const updateBanner = document.createElement('div');
            updateBanner.style.cssText = `
                position: fixed; top: 20px; left: 20px; right: 20px; z-index: 10000;
                background: #10B981; color: white; padding: 12px 16px; border-radius: 8px;
                display: flex; align-items: center; justify-content: space-between;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2); animation: slideDown 0.3s ease;
            `;
            updateBanner.innerHTML = `
                <span>🎉 New features available! Refresh to update.</span>
                <button onclick="window.location.reload()" style="padding: 4px 12px; background: rgba(255,255,255,0.2); border: none; border-radius: 4px; color: white; cursor: pointer;">Refresh</button>
            `;
            document.body.appendChild(updateBanner);

            setTimeout(() => updateBanner.remove(), 10000);
        }

        // Add animation keyframes
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
            @keyframes slideDown { from { transform: translateY(-100%); } to { transform: translateY(0); } }
        `;
        document.head.appendChild(style);</script></body></html>